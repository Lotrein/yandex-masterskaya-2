# yandex-masterskaya-2
**Цель проекта**: разработать алгоритм, который для всех товаров из ***validation.csv*** предложит несколько вариантов наиболее похожих товаров из датасета **base.csv**.

**Условия**:
- оценить качество алгоритма по метрике accuracy@5;
- использовать faiss или аналогичные инструменты, использующие метод приближённого поиска ближайших соседей.

Для проекта предоставлено 4 датасета:
- **train.csv** - тренировочный датасет. Имеет поле с целевым признаком. Каждая строчка - один товар, для которого известен уникальный id (0-query, 1-query, …), вектор признаков и id товара из base.csv, который максимально похож на него **по мнению экспертов**;
- **base.csv** - тестовый датасет. Поле с целевым признаком отсутствует, его требуется расчитать. Представляет из себя нонимизированный набор товаров. Каждый товар представлен как уникальный id (0-base, 1-base, 2-base) и вектор признаков размерностью 72;
- **validation.csv** - валидационный датасет. Список товаров (уникальный id и вектор признаков), для которых надо найти наиболее близкие товары из base.csv
- **validation_answer.csv** - датасет с правильными ответами для оценки.

Общий ход работы:
1. Импортировали необходимые библиотеки и выгрузили необходимые датасеты с Яндекс.Диска;
2. Выполнили обзор датасетов и провели исследовательский анализ данных;
3. Написали функцию поиска ближайших соседей и проверили её на тренировочном датасете;
4. В качестве предобработки данных удалили столбцы, распределение данных которое отличалось от **нормального** - в итоге это существенно повысило качество метрики `accuracy@5` при повторном выполнении поиска ближайших соседей;
5. Обучили модель `CatBoostClassifier` на датасете со "склеенными" векторами `df_base` и `df_train`;
6. Создали аналогичный "склеенный" датасет `df_base` и `df_validation` и выполнили предсказания на нём;
7. Посчитали качество метрики `accuracy@5`.

WARN:
На текущий момент блок с моделью CatBoostClassifier не позволяет корректно выполнить предсказания и посчитать метрику `accuracy@5`.
Близкие к цели проекта результаты показывает `faiss`.
